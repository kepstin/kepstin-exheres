# Copyright 2014 Calvin Walton <calvin.walton@kepstin.ca>
# Distributed under the terms of the GNU General Public License v2

require pypi
require setup-py [ import=distutils ]

SUMMARY="Fixtures, reusable state for writing clean tests and more."
DESCRIPTION="
Fixtures defines a Python contract for reusable state / support logic,
primarily for unit testing. Helper and adaption logic is included to
make it easy to write your own fixtures using the fixtures contract.
Glue code is provided that makes using fixtures that meet the Fixtures
contract in unittest compatible test cases easy and straight forward.
"
HOMEPAGE="https://launchpad.net/python-fixtures"

LICENCES="|| ( Apache-2.0 BSD-3 )"
SLOT="0"
PLATFORMS="~amd64"
MYOPTIONS=""

DEPENDENCIES="
    build+run:
        dev-python/testtools[>=0.9.22][python_abis:*(-)?]
"

setup-py_test_one_multibuild() {
    # The tests reference uninstalled documentation files by relative path,
    # so they have to be run in the source dir, not build dir.
    PYTHONPATH="$(ls -d ${PWD}/lib)" edo ${PYTHON} -B -m testtools.run \
        fixtures.test_suite
}

